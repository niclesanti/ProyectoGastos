@startuml DiagramaDeClasesUML

' ====================================================================
' DEFINICION DE CLASES DEL MODELO (ENTIDADES DE DOMINIO)
' ====================================================================

class Usuario {
  - id: UUID
  - nombre: String
  - email: String
  - fotoPerfil: String
  - proveedor: ProveedorAutenticacion
  - idProveedor: String
  - rol: String
  - activo: Boolean
  - fechaRegistro: LocalDateTime
  - fechaUltimoAcceso: LocalDateTime
}

class EspacioTrabajo {
  - id: UUID
  - nombre: String
  - saldo: BigDecimal
  - fechaCreacion: LocalDateTime
  - fechaModificacion: LocalDateTime
  + actualizarSaldoNuevaTransaccion(monto: BigDecimal, tipo: TipoTransaccion): void
  + actualizarSaldoEliminarTransaccion(monto: BigDecimal, tipo: TipoTransaccion): void
}

class CuentaBancaria {
  - id: Long
  - nombre: String
  - entidadFinanciera: String
  - saldoActual: BigDecimal
  + actualizarSaldoNuevaTransaccion(monto: BigDecimal, tipo: TipoTransaccion): void
  + actualizarSaldoEliminarTransaccion(monto: BigDecimal, tipo: TipoTransaccion): void
}

class Transaccion {
  - id: Long
  - tipo: TipoTransaccion
  - monto: BigDecimal
  - fecha: LocalDate
  - descripcion: String
  - nombreCompletoAuditoria: String
  - fechaCreacion: LocalDateTime
}

class MotivoTransaccion {
  - id: Long
  - motivo: String
}

class ContactoTransferencia {
  - id: Long
  - nombre: String
}

class Tarjeta {
  - id: Long
  - numeroTarjeta: String
  - entidadFinanciera: String
  - redDePago: String
  - diaCierre: Integer
  - diaVencimientoPago: Integer
}

class CompraCredito {
  - id: Long
  - fechaCompra: LocalDate
  - montoTotal: BigDecimal
  - cantidadCuotas: int
  - cuotasPagadas: int
  - descripcion: String
  - nombreCompletoAuditoria: String
  - fechaCreacion: LocalDateTime
  + pagarCuota(): void
}

class CuotaCredito {
  - id: Long
  - numeroCuota: int
  - fechaVencimiento: LocalDate
  - montoCuota: BigDecimal
  - pagada: boolean
  + pagarCuota(): void
}

class Resumen {
  - id: Long
  - anio: Integer
  - mes: Integer
  - fechaVencimiento: LocalDate
  - estado: EstadoResumen
  - montoTotal: BigDecimal
  + asociarTransaccion(transaccion: Transaccion): void
}

class GastosIngresosMensuales {
  - id: Long
  - anio: Integer
  - mes: Integer
  - gastos: BigDecimal
  - ingresos: BigDecimal
  + actualizarGastos(nuevoGasto: BigDecimal): void
  + actualizarIngresos(nuevoIngreso: BigDecimal): void
  + eliminarGastos(nuevoGasto: BigDecimal): void
  + eliminarIngresos(nuevoIngreso: BigDecimal): void
}

class Notificacion {
  - id: Long
  - tipo: TipoNotificacion
  - mensaje: String
  - leida: Boolean
  - fechaCreacion: LocalDateTime
  - fechaLeida: LocalDateTime
}

class SolicitudPendienteEspacioTrabajo {
  - id: Long
  - fechaCreacion: LocalDateTime
}

class CustomOAuth2User {
  - usuario: Usuario
}

enum TipoTransaccion {
  INGRESO
  GASTO
}

enum ProveedorAutenticacion {
  GOOGLE
  FACEBOOK
  GITHUB
}

enum EstadoResumen {
  ABIERTO
  CERRADO
  PAGADO
  PAGADO_PARCIAL
}

enum TipoNotificacion {
  CIERRE_TARJETA
  VENCIMIENTO_RESUMEN
  INVITACION_ESPACIO
  MIEMBRO_AGREGADO
  SISTEMA
}

' ====================================================================
' ASOCIACIONES ENTRE CLASES DEL MODELO
' ====================================================================

Usuario "1" -- "0..*" EspacioTrabajo : "es admin de"
Usuario "0..*" -- "0..*" EspacioTrabajo : "participa en"
Usuario "1" -- "0..*" Notificacion : "recibe"
Usuario "1" -- "0..*" SolicitudPendienteEspacioTrabajo : "es invitado a"

EspacioTrabajo "1" -- "0..*" CuentaBancaria : "tiene"
EspacioTrabajo "1" -- "0..*" Transaccion : "registra"
EspacioTrabajo "1" -- "0..*" MotivoTransaccion : "define"
EspacioTrabajo "1" -- "0..*" ContactoTransferencia : "registra"
EspacioTrabajo "1" -- "0..*" Tarjeta : "registra"
EspacioTrabajo "1" -- "0..*" CompraCredito : "tiene"
EspacioTrabajo "1" -- "0..*" GastosIngresosMensuales : "posee"
EspacioTrabajo "1" -- "0..*" SolicitudPendienteEspacioTrabajo : "genera"

Transaccion "0..*" -- "1" MotivoTransaccion : "tiene un"
Transaccion "0..*" -- "0..1" ContactoTransferencia : "asociada a un"
Transaccion "0..*" -- "0..1" CuentaBancaria : "afecta a"

Tarjeta "1" -- "0..*" CompraCredito : "utiliza"
Tarjeta "1" -- "0..*" Resumen : "genera"

CompraCredito "1" -- "1..*" CuotaCredito : "genera"
CompraCredito "0..*" -- "1" MotivoTransaccion : "categorizada por"
CompraCredito "0..*" -- "0..1" ContactoTransferencia : "realizada en"

CuotaCredito "0..*" -- "0..1" Resumen : "incluida en"

Resumen "0..1" -- "0..1" Transaccion : "pagado con"

Notificacion "0..*" -- "1" TipoNotificacion : "tiene un"

' ====================================================================
' DEFINICION DE DTOs (DATA TRANSFER OBJECTS)
' ====================================================================

class UsuarioDTO {
  - id: Long
  - nombre: String
  - email: String
  + fromUsuario(usuario: Usuario): UsuarioDTO
}

class UsuarioDTOResponse {
  - id: Long
  - nombre: String
  - email: String
  - fotoPerfil: String
}

class EspacioTrabajoDTORequest {
  - nombre: String
  - saldo: BigDecimal
  - idUsuarioAdmin: Long
}

class EspacioTrabajoDTOResponse {
  - id: Long
  - nombre: String
  - saldo: BigDecimal
}

class CuentaBancariaDTORequest {
  - nombre: String
  - entidadFinanciera: String
  - saldoActual: BigDecimal
  - idEspacioTrabajo: Long
}

class CuentaBancariaDTOResponse {
  - id: Long
  - nombre: String
  - entidadFinanciera: String
  - saldoActual: BigDecimal
}

class TransaccionDTORequest {
  - tipo: TipoTransaccion
  - monto: BigDecimal
  - fecha: LocalDate
  - descripcion: String
  - idEspacioTrabajo: Long
  - idMotivo: Long
  - idContacto: Long
  - idCuentaBancaria: Long
  - nombreCompletoAuditoria: String
}

class TransaccionDTOResponse {
  - id: Long
  - tipo: TipoTransaccion
  - monto: BigDecimal
  - fecha: LocalDate
  - descripcion: String
  - nombreCompletoAuditoria: String
  - fechaCreacion: LocalDateTime
  - motivoNombre: String
  - contactoNombre: String
  - cuentaBancariaNombre: String
}

class TransaccionBusquedaDTO {
  - idEspacioTrabajo: Long
  - tipo: TipoTransaccion
  - fechaInicio: LocalDate
  - fechaFin: LocalDate
  - idMotivo: Long
  - idContacto: Long
  - idCuentaBancaria: Long
}

class MotivoDTORequest {
  - motivo: String
  - idEspacioTrabajo: Long
}

class MotivoDTOResponse {
  - id: Long
  - motivo: String
}

class ContactoDTORequest {
  - nombre: String
  - idEspacioTrabajo: Long
}

class ContactoDTOResponse {
  - id: Long
  - nombre: String
}

class TarjetaDTORequest {
  - numeroTarjeta: String
  - entidadFinanciera: String
  - redDePago: String
  - diaCierre: Integer
  - diaVencimientoPago: Integer
  - idEspacioTrabajo: Long
}

class TarjetaDTOResponse {
  - id: Long
  - numeroTarjeta: String
  - entidadFinanciera: String
  - redDePago: String
  - diaCierre: Integer
  - diaVencimientoPago: Integer
}

class CompraCreditoDTORequest {
  - fechaCompra: LocalDate
  - montoTotal: BigDecimal
  - cantidadCuotas: int
  - descripcion: String
  - idEspacioTrabajo: Long
  - idMotivo: Long
  - idComercio: Long
  - idTarjeta: Long
  - nombreCompletoAuditoria: String
}

class CompraCreditoDTOResponse {
  - id: Long
  - fechaCompra: LocalDate
  - montoTotal: BigDecimal
  - cantidadCuotas: int
  - cuotasPagadas: int
  - descripcion: String
  - nombreCompletoAuditoria: String
  - fechaCreacion: LocalDateTime
  - motivoNombre: String
  - comercioNombre: String
  - tarjetaNumero: String
  - tarjetaEntidad: String
}

class CuotaCreditoDTORequest {
  - id: Long
}

class CuotaCreditoDTOResponse {
  - id: Long
  - numeroCuota: int
  - fechaVencimiento: LocalDate
  - montoCuota: BigDecimal
  - pagada: boolean
  - idCompraCredito: Long
  - descripcionCompra: String
}

class PagarResumenTarjetaRequest {
  - cuotas: List<CuotaCreditoDTORequest>
  - transaccion: TransaccionDTORequest
}

class ResumenDTOResponse {
  - id: Long
  - anio: Integer
  - mes: Integer
  - fechaVencimiento: LocalDate
  - estado: EstadoResumen
  - montoTotal: BigDecimal
  - idTarjeta: Long
  - numeroTarjeta: String
  - entidadFinanciera: String
  - redDePago: String
  - idTransaccionAsociada: Long
  - cantidadCuotas: Integer
  - cuotas: List<CuotaResumenDTO>
}

class CuotaResumenDTO {
  - id: Long
  - numeroCuota: Integer
  - montoCuota: BigDecimal
  - descripcion: String
  - totalCuotas: Integer
  - motivo: String
}

class DashboardStatsDTO {
  - balanceTotal: BigDecimal
  - gastosMensuales: BigDecimal
  - resumenMensual: BigDecimal
  - deudaTotalPendiente: BigDecimal
  - flujoMensual: List<IngresosGastosMesDTO>
  - distribucionGastos: List<DistribucionGastoDTO>
}

class IngresosGastosMesDTO {
  - mes: Integer
  - totalIngresos: BigDecimal
  - totalGastos: BigDecimal
}

class IngresosGastosMesDTOImpl {
  - mes: Integer
  - totalIngresos: BigDecimal
  - totalGastos: BigDecimal
}

class DistribucionGastoDTO {
  - motivo: String
  - porcentaje: BigDecimal
}

class SaldoAcumuladoMesDTO {
  - mes: Integer
  - saldoAcumulado: BigDecimal
}

class SaldoAcumuladoMesDTOImpl {
  - mes: Integer
  - saldoAcumulado: BigDecimal
}

class NotificacionDTOResponse {
  - id: Long
  - tipo: TipoNotificacion
  - mensaje: String
  - leida: Boolean
  - fechaCreacion: LocalDateTime
  - fechaLeida: LocalDateTime
}

class SolicitudPendienteEspacioTrabajoDTOResponse {
  - id: Long
  - espacioTrabajoNombre: String
  - usuarioAdminNombre: String
  - fotoPerfilUsuarioAdmin: String
  - fechaCreacion: LocalDateTime
}

' ====================================================================
' DEFINICION DE REPOSITORIOS (DAOs)
' ====================================================================

interface UsuarioRepository <<repository>>
interface EspacioTrabajoRepository <<repository>>
interface CuentaBancariaRepository <<repository>>
interface TransaccionRepository <<repository>>
interface MotivoTransaccionRepository <<repository>>
interface ContactoTransferenciaRepository <<repository>>
interface TarjetaRepository <<repository>>
interface CompraCreditoRepository <<repository>>
interface CuotaCreditoRepository <<repository>>
interface DashboardRepository <<repository>>
interface ResumenRepository <<repository>>
interface GastosIngresosMensualesRepository <<repository>>
interface NotificacionRepository <<repository>>
interface SolicitudPendienteEspacioTrabajoRepository <<repository>>

' ====================================================================
' DEFINICION DE MAPPERS
' ====================================================================

interface EspacioTrabajoMapper <<mapper>>
interface CuentaBancariaMapper <<mapper>>
interface TransaccionMapper <<mapper>>
interface MotivoTransaccionMapper <<mapper>>
interface ContactoTransferenciaMapper <<mapper>>
interface TarjetaMapper <<mapper>>
interface CompraCreditoMapper <<mapper>>
interface CuotaCreditoMapper <<mapper>>
interface UsuarioMapper <<mapper>>
interface ResumenMapper <<mapper>>
interface NotificacionMapper <<mapper>>
interface SolicitudPendienteEspacioTrabajoMapper <<mapper>>

' ====================================================================
' DEFINICION DE EVENTOS
' ====================================================================

class NotificacionEvent <<event>> {
  - idUsuario: UUID
  - tipo: TipoNotificacion
  - mensaje: String
}

class NotificacionEventListener <<listener>> {
  + handleNotificacionEvent(event: NotificacionEvent): void
}

class NotificacionScheduler <<scheduler>> {
  + limpiarNotificacionesLeidas(): void
  + limpiarNotificacionesAntiguas(): void
}

' ====================================================================
' DEFINICION DE SERVICIOS
' ====================================================================

interface EspacioTrabajoService <<service>> {
  + registrarEspacioTrabajo(espacioTrabajoDTO: EspacioTrabajoDTORequest, userId: UUID): void
  + responderSolicitudCompartirEspacioTrabajo(idSolicitud: Long, aceptada: Boolean): void
  + listarSolicitudesPendientes(idUsuario: UUID): List<SolicitudPendienteEspacioTrabajoDTOResponse>
  + listarEspaciosTrabajoPorUsuario(idUsuario: UUID): List<EspacioTrabajoDTOResponse>
  + obtenerMiembrosEspacioTrabajo(idEspacioTrabajo: UUID): List<UsuarioDTOResponse>
}

class EspacioTrabajoServiceImpl <<service>> {
  + registrarEspacioTrabajo(espacioTrabajoDTO: EspacioTrabajoDTORequest, userId: UUID): void
  + compartirEspacioTrabajo(email: String, idEspacioTrabajo: UUID): void
  + responderSolicitudCompartirEspacioTrabajo(idSolicitud: Long, aceptada: Boolean): void
  + listarSolicitudesPendientes(idUsuario: UUID): List<SolicitudPendienteEspacioTrabajoDTOResponse> userId: UUID): void
  + compartirEspacioTrabajo(email: String, idEspacioTrabajo: UUID): void
  + listarEspaciosTrabajoPorUsuario(idUsuario: UUID): List<EspacioTrabajoDTOResponse>
  + obtenerMiembrosEspacioTrabajo(idEspacioTrabajo: UUID): List<UsuarioDTOResponse>
}

interface CuentaBancariaService <<service>> {
  + crearCuentaBancaria(cuentaBancariaDTO: CuentaBancariaDTORequest): void
  + actualizarCuentaBancaria(id: Long, tipo: TipoTransaccion, monto: BigDecimal): CuentaBancaria
  + listarCuentasBancarias(idEspacioTrabajo: UUID): List<CuentaBancariaDTOResponse>
  + transaccionEntreCuentas(idCuentaOrigen: Long, idCuentaDestino: Long, monto: BigDecimal): void
}

class CuentaBancariaServiceImpl <<service>> {
  + crearCuentaBancaria(cuentaBancariaDTO: CuentaBancariaDTORequest): void
  + actualizarCuentaBancaria(id: Long, tipo: TipoTransaccion, monto: BigDecimal): CuentaBancaria
  + listarCuentasBancarias(idEspacioTrabajo: UUID): List<CuentaBancariaDTOResponse>
  + transaccionEntreCuentas(idCuentaOrigen: Long, idCuentaDestino: Long, monto: BigDecimal): void
}

interface TransaccionService <<service>> {
  + registrarTransaccion(transaccionDTO: TransaccionDTORequest): TransaccionDTOResponse
  + removerTransaccion(id: Long): void
  + buscarTransaccion(datosBusqueda: TransaccionBusquedaDTO): List<TransaccionDTOResponse>
  + registrarContactoTransferencia(contactoDTO: ContactoDTORequest): ContactoDTOResponse
  + nuevoMotivoTransaccion(motivoDTO: MotivoDTORequest): MotivoDTOResponse
  + listarContactos(idEspacioTrabajo: UUID): List<ContactoDTOResponse>
  + listarMotivos(idEspacioTrabajo: UUID): List<MotivoDTOResponse>
  + buscarTransaccionesRecientes(idEspacioTrabajo: UUID): List<TransaccionDTOResponse>
}

class TransaccionServiceImpl <<service>> {
  + registrarTransaccion(transaccionDTO: TransaccionDTORequest): TransaccionDTOResponse
  + removerTransaccion(id: Long): void
  + buscarTransaccion(datosBusqueda: TransaccionBusquedaDTO): List<TransaccionDTOResponse>
  + registrarContactoTransferencia(contactoDTO: ContactoDTORequest): ContactoDTOResponse
  + nuevoMotivoTransaccion(motivoDTO: MotivoDTORequest): MotivoDTOResponse
  + listarContactos(idEspacioTrabajo: UUID): List<ContactoDTOResponse>
  + listarMotivos(idEspacioTrabajo: UUID): List<MotivoDTOResponse>
  + buscarTransaccionesRecientes(idEspacioTrabajo: UUID): List<TransaccionDTOResponse>
}

interface CompraCreditoService <<service>> {
  + registrarCompraCredito(compraCreditoDTO: CompraCreditoDTORequest): CompraCreditoDTOResponse
  + removerCompraCredito(id: Long): void
  + listarComprasCreditoDebeCuotas(idEspacioTrabajo: UUID): List<CompraCreditoDTOResponse>
  + BuscarComprasCredito(idEspacioTrabajo: UUID): List<CompraCreditoDTOResponse>
  + registrarTarjeta(tarjetaDTO: TarjetaDTORequest): TarjetaDTOResponse
  + removerTarjeta(id: Long): void
  + modificarTarjeta(id: Long, diaCierre: Integer, diaVencimientoPago: Integer): TarjetaDTOResponse
  + listarTarjetas(idEspacioTrabajo: UUID): List<TarjetaDTOResponse>
  + listarCuotasPorTarjeta(idTarjeta: Long): List<CuotaCreditoDTOResponse>
  + pagarResumenTarjeta(request: PagarResumenTarjetaRequest): void
  + listarResumenesPorTarjeta(idTarjeta: Long): List<ResumenDTOResponse>
  + listarResumenesPorEspacioTrabajo(idEspacioTrabajo: UUID): List<ResumenDTOResponse>
}

class CompraCreditoServiceImpl <<service>> {
  + registrarCompraCredito(compraCreditoDTO: CompraCreditoDTORequest): CompraCreditoDTOResponse
  + removerCompraCredito(id: Long): void
  + listarComprasCreditoDebeCuotas(idEspacioTrabajo: UUID): List<CompraCreditoDTOResponse>
  + BuscarComprasCredito(idEspacioTrabajo: UUID): List<CompraCreditoDTOResponse>
  + registrarTarjeta(tarjetaDTO: TarjetaDTORequest): TarjetaDTOResponse
  + removerTarjeta(id: Long): void
  + modificarTarjeta(id: Long, diaCierre: Integer, diaVencimientoPago: Integer): TarjetaDTOResponse
  + listarTarjetas(idEspacioTrabajo: UUID): List<TarjetaDTOResponse>
  + listarCuotasPorTarjeta(idTarjeta: Long): List<CuotaCreditoDTOResponse>
  + pagarResumenTarjeta(request: PagarResumenTarjetaRequest): void
  + listarResumenesPorTarjeta(idTarjeta: Long): List<ResumenDTOResponse>
  + listarResumenesPorEspacioTrabajo(idEspacioTrabajo: UUID): List<ResumenDTOResponse>
}

interface DashboardService <<service>> {
  + obtenerDashboardStats(idEspacio: UUID): DashboardStatsDTO
}

class DashboardServiceImpl <<service>> {
  + obtenerDashboardStats(idEspacio: UUID): DashboardStatsDTO
}

class CustomOidcUserService <<service>> {
  + loadUser(userRequest: OidcUserRequest): OidcUser
}

interface SecurityService <<service>> {
  + getAuthenticatedUserId(): UUID
  + validateWorkspaceAccess(workspaceId: UUID): void
  + validateWorkspaceAdmin(workspaceId: UUID): void
  + validateTransactionOwnership(transactionId: Long): void
  + validateCompraCreditoOwnership(compraCreditoId: Long): void
  + validateCuentaBancariaOwnership(cuentaBancariaId: Long): void
  + validateTarjetaOwnership(tarjetaId: Long): void
  + hasWorkspaceAccess(workspaceId: UUID): boolean
  + isWorkspaceAdmin(workspaceId: UUID): boolean
}

class SecurityServiceImpl <<service>> {
  + getAuthenticatedUserId(): UUID
  + validateWorkspaceAccess(workspaceId: UUID): void
  + validateWorkspaceAdmin(workspaceId: UUID): void
  + validateTransactionOwnership(transactionId: Long): void
  + validateCompraCreditoOwnership(compraCreditoId: Long): void
  + validateCuentaBancariaOwnership(cuentaBancariaId: Long): void
  + validateTarjetaOwnership(tarjetaId: Long): void
  + hasWorkspaceAccess(workspaceId: UUID): boolean
  + isWorkspaceAdmin(workspaceId: UUID): boolean
}

interface NotificacionService <<service>> {
  + obtenerNotificacionesUsuario(idUsuario: UUID): List<NotificacionDTOResponse>
  + contarNoLeidas(idUsuario: UUID): Long
  + marcarComoLeida(id: Long): void
  + marcarTodasLeidas(idUsuario: UUID): void
  + eliminarNotificacion(id: Long): void
  + limpiarNotificacionesLeidas(): void
  + limpiarNotificacionesAntiguas(): void
}

class NotificacionServiceImpl <<service>> {
  + obtenerNotificacionesUsuario(idUsuario: UUID): List<NotificacionDTOResponse>
  + contarNoLeidas(idUsuario: UUID): Long
  + marcarComoLeida(id: Long): void
  + marcarTodasLeidas(idUsuario: UUID): void
  + eliminarNotificacion(id: Long): void
  + limpiarNotificacionesLeidas(): void
  + limpiarNotificacionesAntiguas(): void
}

interface SseEmitterService <<service>> {
  + crearEmitter(idUsuario: UUID): SseEmitter
  + enviarNotificacion(idUsuario: UUID, notificacion: Notificacion): void
  + getActiveConnections(): int
}

class SseEmitterServiceImpl <<service>> {
  + crearEmitter(idUsuario: UUID): SseEmitter
  + enviarNotificacion(idUsuario: UUID, notificacion: Notificacion): void
  + getActiveConnections(): int
}

' ====================================================================
' ASOCIACIONES CAPA SERVICIO (IMPLEMENTACIONES)
' ====================================================================

EspacioTrabajoServiceImpl ..|> EspacioTrabajoService
CuentaBancariaServiceImpl ..|> CuentaBancariaService
TransaccionServiceImpl ..|> TransaccionService
CompraCreditoServiceImpl ..|> CompraCreditoService
DashboardServiceImpl ..|> DashboardService
SecurityServiceImpl ..|> SecurityService
NotificacionServiceImpl ..|> NotificacionService
SseEmitterServiceImpl ..|> SseEmitterService

' ====================================================================
EspacioTrabajoServiceImpl ..> SolicitudPendienteEspacioTrabajoRepository
' ASOCIACIONES CAPA SERVICIO -> REPOSITORIO
' ====================================================================

EspacioTrabajoServiceImpl ..> EspacioTrabajoRepository
EspacioTrabajoServiceImpl ..> UsuarioRepository

CuentaBancariaServiceImpl ..> CuentaBancariaRepository
CuentaBancariaServiceImpl ..> EspacioTrabajoRepository

TransaccionServiceImpl ..> TransaccionRepository
TransaccionServiceImpl ..> EspacioTrabajoRepository
TransaccionServiceImpl ..> MotivoTransaccionRepository
TransaccionServiceImpl ..> ContactoTransferenciaRepository
TransaccionServiceImpl ..> CuentaBancariaRepository
TransaccionServiceImpl ..> CuentaBancariaService
TransaccionServiceImpl ..> GastosIngresosMensualesRepository

CompraCreditoServiceImpl ..> CompraCreditoRepository
CompraCreditoServiceImpl ..> CuotaCreditoRepository
CompraCreditoServiceImpl ..> TarjetaRepository
CompraCreditoServiceImpl ..> EspacioTrabajoRepository
CompraCreditoServiceImpl ..> MotivoTransaccionRepository
CompraCreditoServiceImpl ..> ContactoTransferenciaRepository
CompraCreditoServiceImpl ..> TransaccionService
CompraCreditoServiceImpl ..> ResumenRepository

DashboardServiceImpl ..> DashboardRepository
DashboardServiceImpl ..> EspacioTrabajoRepository
DashboardServiceImpl ..> GastosIngresosMensualesRepository
DashboardServiceImpl ..> ResumenRepository

CustomOidcUserService ..> UsuarioRepository

SecurityServiceImpl ..> EspacioTrabajoRepository
SecurityServiceImpl ..> TransaccionRepository
SecurityServiceImpl ..> CompraCreditoRepository
SecurityServiceImpl ..> CuentaBancariaRepository
SecurityServiceImpl ..> TarjetaRepository

NotificacionServiceImpl ..> NotificacionRepository

NotificacionEventListener ..> NotificacionRepository
NotificacionEventListener ..> UsuarioRepository
NotificacionEventListener ..> SseEmitterService

NotificacionScheduler ..> NotificacionService

' ====================================================================
' ASOCIACIONES CAPA SERVICIO -> MAPPER
' ====================================================================

EspacioTrabajoServiceImpl ..> EspacioTrabajoMapper
CuentaBancariaServiceImpl ..> CuentaBancariaMapper
TransaccionServiceImpl ..> TransaccionMapper
TransaccionServiceImpl ..> MotivoTransaccionMapper
TransaccionServiceImpl ..> ContactoTransferenciaMapper
CompraCreditoServiceImpl ..> CompraCreditoMapper
CompraCreditoServiceImpl ..> CuotaCreditoMapper
CompraCreditoServiceImpl ..> TarjetaMapper
CompraCreditoServiceImpl ..> ResumenMapper
EspacioTrabajoServiceImpl ..> UsuarioMapper

NotificacionServiceImpl ..> NotificacionMapper
SseEmitterServiceImpl ..> NotificacionMapper

' ====================================================================
' ASOCIACIONES CAPA REPOSITORIO -> MODELO
' ====================================================================

UsuarioRepository ..> Usuario
EspacioTrabajoRepository ..> EspacioTrabajo
CuentaBancariaRepository ..> CuentaBancaria
TransaccionRepository ..> Transaccion
MotivoTransaccionRepository ..> MotivoTransaccion
ContactoTransferenciaRepository ..> ContactoTransferencia
TarjetaRepository ..> Tarjeta
CompraCreditoRepository ..> CompraCredito
CuotaCreditoRepository ..> CuotaCredito
ResumenRepository ..> Resumen
GastosIngresosMensualesRepository ..> GastosIngresosMensuales
NotificacionRepository ..> Notificacion

' ====================================================================
' ASOCIACIONES CAPA MAPPER -> MODELO Y DTOs
' ====================================================================

EspacioTrabajoMapper ..> EspacioTrabajo
EspacioTrabajoMapper ..> EspacioTrabajoDTORequest
EspacioTrabajoMapper ..> EspacioTrabajoDTOResponse

CuentaBancariaMapper ..> CuentaBancaria
CuentaBancariaMapper ..> CuentaBancariaDTORequest
CuentaBancariaMapper ..> CuentaBancariaDTOResponse

TransaccionMapper ..> Transaccion
TransaccionMapper ..> TransaccionDTORequest
TransaccionMapper ..> TransaccionDTOResponse

MotivoTransaccionMapper ..> MotivoTransaccion
MotivoTransaccionMapper ..> MotivoDTORequest
MotivoTransaccionMapper ..> MotivoDTOResponse

ContactoTransferenciaMapper ..> ContactoTransferencia
ContactoTransferenciaMapper ..> ContactoDTORequest
ContactoTransferenciaMapper ..> ContactoDTOResponse

TarjetaMapper ..> Tarjeta
TarjetaMapper ..> TarjetaDTORequest
TarjetaMapper ..> TarjetaDTOResponse

CompraCreditoMapper ..> CompraCredito
CompraCreditoMapper ..> CompraCreditoDTORequest
CompraCreditoMapper ..> CompraCreditoDTOResponse

CuotaCreditoMapper ..> CuotaCredito
CuotaCreditoMapper ..> CuotaCreditoDTORequest
CuotaCreditoMapper ..> CuotaCreditoDTOResponse

UsuarioMapper ..> Usuario
UsuarioMapper ..> UsuarioDTOResponse

ResumenMapper ..> Resumen
ResumenMapper ..> ResumenDTOResponse

NotificacionMapper ..> Notificacion
NotificacionMapper ..> NotificacionDTOResponse

' ====================================================================
' ASOCIACIONES EVENTOS
' ====================================================================

NotificacionEvent ..> TipoNotificacion
NotificacionEventListener ..> NotificacionEvent

@enduml